<!DOCTYPE html><html lang="ko-KR" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[백엔드 스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법)" /><meta name="author" content="TaemHam" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="This is a wannabe backend developer’s dev blog." /><meta property="og:description" content="This is a wannabe backend developer’s dev blog." /><link rel="canonical" href="https://taemham.github.io/posts/SpringBoot_AboutSpringSecurity/" /><meta property="og:url" content="https://taemham.github.io/posts/SpringBoot_AboutSpringSecurity/" /><meta property="og:site_name" content="TaemHam" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-09T09:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[백엔드 스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법)" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"TaemHam","url":"https://github.com/TaemHam/"},"dateModified":"2023-02-22T10:13:55+09:00","datePublished":"2023-02-09T09:00:00+09:00","description":"This is a wannabe backend developer’s dev blog.","headline":"[백엔드 스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법)","mainEntityOfPage":{"@type":"WebPage","@id":"https://taemham.github.io/posts/SpringBoot_AboutSpringSecurity/"},"url":"https://taemham.github.io/posts/SpringBoot_AboutSpringSecurity/"}</script><title>[백엔드|스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법) | TaemHam</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="TaemHam"><meta name="application-name" content="TaemHam"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/TaemHam/Taemham.github.io/main/assets/img/pics/TaemHam_Face.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">TaemHam</a></div><div class="site-subtitle font-italic">and his devlog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/TaemHam" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['tk4003950','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[백엔드|스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>[백엔드|스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법)</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1675900800" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-02-09 </em> </span> <span> 업데이트 <em class="" data-ts="1677028435" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-02-22 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/TaemHam/">TaemHam</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4014 단어"> <em>22 분</em>읽는 시간</span></div></div></div><div class="post-content"><p><img data-src="https://velog.velcdn.com/images/seongwon97/post/0c166ca6-19e3-4eef-9f3a-82540cf2fea4/spring%20security.png" alt="스프링 시큐리티" data-proofer-ignore></p><h2 id="개요"><span class="mr-2">개요</span><a href="#개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>애플리케이션 개발에 사용자 인증과 인가 등의 보안 기능은 거의 필수적으로 구현해야할 사항이다. 보통은 아이디와 비밀번호를 서버에 전달해 사용자를 인증하는 방법을 사용하는데, 스프링부트는 이걸 어떻게 처리할까? 쿠키나 세션 방식같은 방법이 있겠지만, 이번에는 JWT라는 토큰값을 활용하는 보안 기법으로 알아보려고 한다.</p><h2 id="spring-security"><span class="mr-2">Spring Security</span><a href="#spring-security" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="개념"><span class="mr-2">개념</span><a href="#개념" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>스프링 시큐리티는 인증, 인가를 지원하고 주요 공격으로부터 어플리케이션을 보호해주는 프레임워크이다.<li>명령형과 리액티브 어플리케이션 모두에서 가장 잘 동작하는, 사실상 스프링 기반 어플리케이션의 표준 보안 프레임워크이다.</ul><h3 id="동작-원리"><span class="mr-2">동작 원리</span><a href="#동작-원리" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://docs.spring.io/spring-security/site/docs/5.5.4/reference/html5/images/servlet/architecture/multi-securityfilterchain.png" alt="스프링 필터 체인 동작 원리" data-proofer-ignore></p><p>스프링 시큐리티는 클라이언트가 디스패처 서블릿에 접근 하기 전, <code class="language-plaintext highlighter-rouge">서블릿 필터</code> 라는 필터 체인을 기반으로 동작한다. 요청은 이 필터를 처리되기 전에 한번, 처리 된 후에 다시 한번 거쳐 지나가게 된다.</p><p>이 필터 체인 역시 서블릿 컨테이너에서 관리하는데, 클라이언트에서 요청이 들어오면 서블릿 컨테이너는 URI를 확인해 필터와 서블릿을 매핑해준다.</p><p>스프링 시큐리티는 이 필터 체인 안의 필터 중 하나로, <code class="language-plaintext highlighter-rouge">DelegatingFilterProxy</code> 라는 자동 생성되는 빈을 통해 보안 필터의 프록시 객체를 필터 체인 안으로 집어넣어 동작시킨다.</p><h3 id="인증-과정"><span class="mr-2">인증 과정</span><a href="#인증-과정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://blog.kakaocdn.net/dn/eSlZLD/btrI3uKHx6R/un89Ir331OWzKuj1STiXfk/img.png" alt="스프링 시큐리티 인증 절차" data-proofer-ignore></p><p>스프링 시큐리티 구조의 처리 과정을 간단히 설명하면 다음과 같다.</p><ol><li>사용자가 로그인 정보와 함께 인증 요청을 한다.(Http Request)<li>AuthenticationFilter가 요청을 가로채고, 가로챈 정보를 통해 UsernamePasswordAuthenticationToken의 인증용 객체를 생성한다.<li>AuthenticationManager의 구현체인 ProviderManager에게 앞에서 생성한 객체를 전달한다.<li>AuthenticationManager는 등록된 AuthenticationProvider(들)을 조회하여 인증을 요구한다.<li>실제 DB에서 사용자 인증정보를 가져오는 UserDetailsService에 사용자 정보를 넘겨준다.<li>넘겨받은 사용자 정보를 통해 DB에서 찾은 사용자 정보인 UserDetails 객체를 만든다.<li>AuthenticationProvider(들)은 UserDetails를 넘겨받고 사용자 정보를 비교한다.<li>인증이 완료되면 권한 등의 사용자 정보를 담은 Authentication 객체를 반환한다.<li>다시 최초의 AuthenticationFilter에 Authentication 객체가 반환된다.<li>Authenticaton 객체를 SecurityContext에 저장한다.</ol><h3 id="설정법"><span class="mr-2">설정법</span><a href="#설정법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>이전에는 WebSecurityConfidurerAdapter 클래스를 상속 받아 보안 필터 체인을 설정했었다. 하지만 현재 이 기능은 Deprecated 되어 사용이 불가능해졌고, 다음과 같이 SecurityFilterChain을 <code class="language-plaintext highlighter-rouge">@Bean</code>으로 등록해 사용해야 한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfiguration</span> <span class="o">{</span>
    
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SecurityFilterChain</span> <span class="nf">filterChain</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">http</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">http</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
                <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>구체적인 설정법에 대해서는 뒤에 가서 알아보도록 하자.</p><h2 id="jwt"><span class="mr-2">JWT</span><a href="#jwt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>JWT(JSON Web Token)는 당사자 간에 정보를 JSON 형태로 안전하게 전송하기 위한 토큰이다. JWT는 다음과 같은 특징이 있다.</p><ul><li>URL로 이용할 수 있는 문자열로만 구성돼 있다.<li>디지털 서명이 적용돼 있어 신뢰할 수 있다.</ul><h3 id="구조"><span class="mr-2">구조</span><a href="#구조" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><img data-src="https://supertokens.com/static/b0172cabbcd583dd4ed222bdb83fc51a/9af93/jwt-structure.png" alt="JWT의 구조" data-proofer-ignore></p><p>JWT는 헤더(Header), 내용(Payload), 서명(Signature) 각각의 부분이 Base64Url 형식으로 인코딩되어 <code class="language-plaintext highlighter-rouge">.</code>으로 구분지어진 구조를 가지고 있다.</p><h4 id="헤더"><span class="mr-2">헤더</span><a href="#헤더" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>JWT의 헤더는 검증과 관련된 내용을 담고 있다. 헤더에는 alg 와 typ, 두 가지 정보를 포함하고 있다.</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"H256"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"typ"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JWT"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>alg 에선 해싱 알고리즘을 지정한다. 해싱 알고리즘은 보통 SHA256 혹은 RSA를 사용하며, 코튼을 검증할 때 사용되는 서명 부분에서 사용된다. typ 에서는 토큰의 타입을 지정한다.</p><h4 id="내용"><span class="mr-2">내용</span><a href="#내용" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"sub"</span><span class="p">:</span><span class="w"> </span><span class="s2">"board service payload"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"exp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1602076408"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"userId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"TaemHam"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>JWT 내용에는 토큰에 담는 정보를 포함한다. 이 정보를 클레임(Claim)이라 하고, 크게 세 가지로 분류된다.</p><ul><li>등록된 클레임(Registered Claim) 등록된 클레임은 필수는 아니지만 토큰에 대한 정보를 담기 위해 이미 이름이 정해져 있는 클레임이다.<ul><li>iss: JWT 발금자 주체.<li>sub: JWT의 제목.<li>aud: JWT의 수신인.<li>exp: JWT의 만료 시간. 형식은 NumericDate 형식이어야 한다.<li>nbf: ‘Not Before’<li>iat: JWT 발급 시간.<li>jti: JWT의 식별자(JWT ID). 주로 중복 처리를 방지하기 위해 사용된다.</ul><li><p>공개 클레임(Public Claim) 등록 클레임과 충돌이 발생하지 않는 선에서 마음대로 정할 수 있는 속성이다.</p><li>비공개 클레임(Private Claim) 비공개 클레임은 통신 간에 상호 합의된, 위의 두 클레임이 아닌 클레임이다.</ul><h4 id="서명"><span class="mr-2">서명</span><a href="#서명" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>JWT의 서명 부분은 인코딩된 헤더, 인코딩된 내용, 비밀키, 헤더의 알고리즘 속성값을 가져와 생성된다. 예를 들어, HMAC SHA256 알고리즘을 사용해 서명을 생성하면 다음과 같이 생성된다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>HMACSHA256(
    base64UrlEncode(header) + "." +
    base64UrlEncode(payload),
    secret
    )
</pre></table></code></div></div><p>서명은 토큰의 값들을 포함해 암호화하기 때문에 메시지가 도중에 변경되지 않았는지 확인할 때 사용한다.</p><h2 id="구현"><span class="mr-2">구현</span><a href="#구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>UserDetails와 UserDetailsService 구현체</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="nd">@Getter</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CustomUserDetails</span> <span class="kd">implements</span> <span class="nc">UserDetails</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">password</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">email</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="n">authorities</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">CustomUserDetails</span> <span class="nf">of</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">String</span> <span class="n">password</span><span class="o">,</span> <span class="nc">String</span> <span class="n">email</span><span class="o">,</span> <span class="nc">UserRole</span> <span class="n">role</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">UserRole</span><span class="o">&gt;</span> <span class="n">rollTypes</span> <span class="o">=</span> <span class="nc">Set</span><span class="o">.</span><span class="na">of</span><span class="o">(</span><span class="n">role</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">CustomUserDetails</span><span class="o">(</span>
                <span class="n">username</span><span class="o">,</span>
                <span class="n">password</span><span class="o">,</span>
                <span class="n">email</span><span class="o">,</span>
                <span class="n">rollTypes</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
                        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">UserRole:</span><span class="o">:</span><span class="n">getName</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">SimpleGrantedAuthority:</span><span class="o">:</span><span class="k">new</span><span class="o">)</span>
                        <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toUnmodifiableSet</span><span class="o">())</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 엔티티에서 UserDto로, 다시 CustomUserDetails로 바꾸기 위한 메서드</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="nc">CustomUserDetails</span> <span class="nf">from</span><span class="o">(</span><span class="nc">UserDto</span> <span class="n">dto</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">CustomUserDetails</span><span class="o">.</span><span class="na">of</span><span class="o">(</span>
                <span class="n">dto</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span>
                <span class="n">dto</span><span class="o">.</span><span class="na">getPassword</span><span class="o">(),</span>
                <span class="n">dto</span><span class="o">.</span><span class="na">getEmail</span><span class="o">(),</span>
                <span class="n">dto</span><span class="o">.</span><span class="na">getRole</span><span class="o">()</span>
        <span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getPassword</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">password</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUsername</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">username</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Collection</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="nc">GrantedAuthority</span><span class="o">&gt;</span> <span class="nf">getAuthorities</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">authorities</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAccountNonExpired</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAccountNonLocked</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isCredentialsNonExpired</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEnabled</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>CustomUserDetails 클래스는 UserDetails 인터페이스를 구현하고 있다. 위의 그림에서 설명했듯이, UserDetails는 UserDetailsService를 통해 입력된 로그인 정보를 가지고 데이터베이스에서 사용자 정보를 가져오는 역할을 수행한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDetailsServiceImpl</span> <span class="kd">implements</span> <span class="nc">UserDetailsService</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserRepository</span> <span class="n">userRepository</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">CustomUserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">CustomUserDetails</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="nc">UserDto</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">userRepository</span><span class="o">.</span><span class="na">findByUsername</span><span class="o">(</span><span class="n">username</span><span class="o">)));</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>JWTTokenProvider 구현</ul><p>JWTTokenProvider는 UserDetails에서 정보를 추출해 JWT 토큰을 생성하는 클래스이다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtTokenProvider</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">UserDetailsService</span> <span class="n">userDetailsService</span><span class="o">;</span>

    <span class="nd">@Value</span><span class="o">(</span><span class="s">"${springboot.jwt.secret}"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">secretKey</span> <span class="o">=</span> <span class="s">"secretKey"</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="kt">long</span> <span class="no">TOKEN_VALID_MILLISECOND</span> <span class="o">=</span> <span class="mi">1000L</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">JwtTokenProvider</span><span class="o">(</span><span class="nc">UserDetailsService</span> <span class="n">userDetailsService</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">userDetailsService</span> <span class="o">=</span> <span class="n">userDetailsService</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="nd">@PostConstruct</span> <span class="c1">// Bean 으로 주입되면서 실행</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">secretKey</span> <span class="o">=</span> <span class="nc">Base64</span><span class="o">.</span><span class="na">getEncoder</span><span class="o">().</span><span class="na">encodeToString</span><span class="o">(</span><span class="n">secretKey</span><span class="o">.</span><span class="na">getBytes</span><span class="o">(</span><span class="nc">StandardCharsets</span><span class="o">.</span><span class="na">UTF_8</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="c1">// 토큰 생성</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">createToken</span><span class="o">(</span><span class="nc">String</span> <span class="n">username</span><span class="o">,</span> <span class="nc">Set</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">roles</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">Claims</span> <span class="n">claims</span> <span class="o">=</span> <span class="nc">Jwts</span><span class="o">.</span><span class="na">claims</span><span class="o">().</span><span class="na">setSubject</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
        <span class="n">claims</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">"roles"</span><span class="o">,</span> <span class="n">roles</span><span class="o">);</span>
        <span class="nc">Date</span> <span class="n">now</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Date</span><span class="o">();</span>

        <span class="k">return</span> <span class="nc">Jwts</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">setClaims</span><span class="o">(</span><span class="n">claims</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setIssuedAt</span><span class="o">(</span><span class="n">now</span><span class="o">)</span>
                <span class="o">.</span><span class="na">setExpiration</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">(</span><span class="n">now</span><span class="o">.</span><span class="na">getTime</span><span class="o">()</span> <span class="o">+</span> <span class="no">TOKEN_VALID_MILLISECOND</span><span class="o">))</span>
                <span class="o">.</span><span class="na">signWith</span><span class="o">(</span><span class="nc">SignatureAlgorithm</span><span class="o">.</span><span class="na">HS256</span><span class="o">,</span> <span class="n">secretKey</span><span class="o">)</span>
                <span class="o">.</span><span class="na">compact</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// 토큰 인증 정보 조회</span>
    <span class="kd">public</span> <span class="nc">Authentication</span> <span class="nf">getAuthentication</span><span class="o">(</span><span class="nc">String</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
        <span class="nc">UserDetails</span> <span class="n">userDetails</span> <span class="o">=</span> <span class="n">userDetailsService</span><span class="o">.</span><span class="na">loadUserByUsername</span><span class="o">(</span><span class="k">this</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(</span><span class="n">token</span><span class="o">));</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nf">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">userDetails</span><span class="o">,</span> <span class="s">""</span><span class="o">,</span> <span class="n">userDetails</span><span class="o">.</span><span class="na">getAuthorities</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="c1">// 토큰 기반 회원 구별 정보 추출</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getUsername</span><span class="o">(</span><span class="nc">String</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="nc">Jwts</span><span class="o">.</span><span class="na">parser</span><span class="o">()</span>
                <span class="o">.</span><span class="na">setSigningKey</span><span class="o">(</span><span class="n">secretKey</span><span class="o">)</span>
                <span class="o">.</span><span class="na">parseClaimsJws</span><span class="o">(</span><span class="n">token</span><span class="o">)</span>
                <span class="o">.</span><span class="na">getBody</span><span class="o">()</span>
                <span class="o">.</span><span class="na">getSubject</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="c1">// HTTP 헤더에서 Token 값 추출</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">resolveToken</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="na">getHeader</span><span class="o">(</span><span class="s">"X-AUTH-TOKEN"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 토큰 유효성 체크</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">validateToken</span><span class="o">(</span><span class="nc">String</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="nc">Jws</span><span class="o">&lt;</span><span class="nc">Claims</span><span class="o">&gt;</span> <span class="n">claims</span> <span class="o">=</span> <span class="nc">Jwts</span><span class="o">.</span><span class="na">parser</span><span class="o">().</span><span class="na">setSigningKey</span><span class="o">(</span><span class="n">secretKey</span><span class="o">).</span><span class="na">parseClaimsJws</span><span class="o">(</span><span class="n">token</span><span class="o">);</span>
            <span class="k">return</span> <span class="o">!</span><span class="n">claims</span><span class="o">.</span><span class="na">getBody</span><span class="o">().</span><span class="na">getExpiration</span><span class="o">().</span><span class="na">before</span><span class="o">(</span><span class="k">new</span> <span class="nc">Date</span><span class="o">());</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>JWTAuthenticationFilter 구현</ul><p>JWTAuthenticationFilter는 헤더로 받은 JWT 토큰을 추출해 유효성을 검사하고, SecurityContextHolder에 Authentication을 부여하는 클래스이다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtAuthenticationFilter</span> <span class="kd">extends</span> <span class="nc">OncePerRequestFilter</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JwtTokenProvider</span> <span class="n">jwtTokenProvider</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">JwtAuthenticationFilter</span><span class="o">(</span><span class="nc">JwtTokenProvider</span> <span class="n">jwtTokenProvider</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">jwtTokenProvider</span> <span class="o">=</span> <span class="n">jwtTokenProvider</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="nc">FilterChain</span> <span class="n">filterChain</span><span class="o">)</span>
            <span class="kd">throws</span> <span class="nc">ServletException</span><span class="o">,</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="c1">// 토큰 추출</span>
        <span class="nc">String</span> <span class="n">token</span> <span class="o">=</span> <span class="n">jwtTokenProvider</span><span class="o">.</span><span class="na">resolveToken</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>

        <span class="c1">// 토큰 유효성 체크</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">token</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">jwtTokenProvider</span><span class="o">.</span><span class="na">validateToken</span><span class="o">(</span><span class="n">token</span><span class="o">))</span> <span class="o">{</span>
            <span class="nc">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="n">jwtTokenProvider</span><span class="o">.</span><span class="na">getAuthentication</span><span class="o">(</span><span class="n">token</span><span class="o">);</span>
            <span class="nc">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">setAuthentication</span><span class="o">(</span><span class="n">authentication</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">filterChain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><ul><li>SecurityConfiguration 구현</ul><p>JWT를 사용하는 SecurityFilterChain은 다음과 같이 구현한다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
</pre><td class="rouge-code"><pre><span class="nd">@RequiredArgsConstructor</span>
<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfiguration</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JwtTokenProvider</span> <span class="n">jwtTokenProvider</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JwtAccessDeniedHandler</span> <span class="n">jwtAccessDeniedHandler</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="nc">JwtAuthenticationEntryPoint</span> <span class="n">jwtAuthenticationEntryPoint</span><span class="o">;</span>

    <span class="c1">// 필터체인을 통과시키지 않을 URI 설정</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">WebSecurityCustomizer</span> <span class="nf">webSecurityCustomizer</span><span class="o">(){</span>
        <span class="k">return</span> <span class="o">(</span><span class="n">web</span><span class="o">)</span> <span class="o">-&gt;</span> <span class="n">web</span><span class="o">.</span><span class="na">ignoring</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/favicon.ico"</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 필터체인 설정</span>
    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="nc">SecurityFilterChain</span> <span class="nf">filterChain</span><span class="o">(</span><span class="nc">HttpSecurity</span> <span class="n">httpSecurity</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">httpSecurity</span>

                <span class="c1">// token을 사용하는 방식이기 때문에 csrf를 disable한다.</span>
                <span class="o">.</span><span class="na">csrf</span><span class="o">().</span><span class="na">disable</span><span class="o">()</span>

                <span class="c1">// 세션을 사용하지 않기 때문에 STATELESS로 설정</span>
                <span class="o">.</span><span class="na">sessionManagement</span><span class="o">()</span>
                <span class="o">.</span><span class="na">sessionCreationPolicy</span><span class="o">(</span><span class="nc">SessionCreationPolicy</span><span class="o">.</span><span class="na">STATELESS</span><span class="o">)</span>

                <span class="o">.</span><span class="na">and</span><span class="o">()</span>

                <span class="c1">// 각 URI 인증 여부 결정</span>
                <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/api/v1/sign-in"</span><span class="o">,</span> <span class="s">"/api/v1/sign-up"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span> <span class="c1">// 허용 경로</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="nc">HttpMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="s">"/api/v1/article"</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span> <span class="c1">// GET 방식만 허용</span>
                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">"/api/v1/user-info"</span><span class="o">).</span><span class="na">hasRole</span><span class="o">(</span><span class="s">"ADMIN"</span><span class="o">)</span> <span class="c1">// Role이 ADMIN 이어야 함</span>
                <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span> <span class="c1">// 나머지 경로는 JWT 인증 필요</span>

                <span class="o">.</span><span class="na">and</span><span class="o">()</span>

                <span class="c1">// 예외 전달 설정 (설명은 이후에 추가)</span>
                <span class="o">.</span><span class="na">exceptionHandling</span><span class="o">()</span>
                <span class="o">.</span><span class="na">authenticationEntryPoint</span><span class="o">(</span><span class="n">jwtAuthenticationEntryPoint</span><span class="o">)</span> <span class="c1">// 커스텀 엔트리포인트</span>
                <span class="o">.</span><span class="na">accessDeniedHandler</span><span class="o">(</span><span class="n">jwtAccessDeniedHandler</span><span class="o">)</span> <span class="c1">// 커스텀 인가 실패 핸들링</span>

                <span class="o">.</span><span class="na">and</span><span class="o">()</span>

                <span class="c1">// JwtAuthenticationFilter 적용</span>
                <span class="o">.</span><span class="na">addFilterBefore</span><span class="o">(</span><span class="k">new</span> <span class="nc">JwtAuthenticationFilter</span><span class="o">(</span><span class="n">jwtTokenProvider</span><span class="o">),</span> <span class="nc">UsernamePasswordAuthenticationFilter</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>WebSecurityCustomizer 는 필터체인의 앞단에 적용되며, 전체적으로 스프링 시큐리티 영향권의 밖에 있는 필터이다. 때문에 인증과 인가가 적용되지 않는 리소스 접근에 대해 사용할 수 있다. “favicon.ico” 외에도, Swagger 를 사용한다면 “/v2/api-docs”, “/swagger-resource/**”, “/swagger-ui.html”, “webjars/**“를, h2 DB를 사용한다면 “/h2/**” 를 추가하기도 한다.</p><p>SecurityFilterChain 를 빈으로 등록해 필터체인을 설정한다. 다음은 각각의 필터에 대한 설명이다.</p><p><code class="language-plaintext highlighter-rouge">csrf().disable()</code>: 스프링 시큐리티의 csrf() 메서드는 기본적으로 CSRF 토큰을 발급해 클라이언트로부터 요청을 받을 때마다 토큰을 검사하는 방식으로 진행한다. REST API 에서는 CSRF 보안이 필요 없기 때문에 비활성화 하는 로직이다.</p><p><code class="language-plaintext highlighter-rouge">sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)</code>: REST API 기반 애플리케이션의 동작 방식을 설정한다. JWT 토큰으로 인증을 처리하며 세션은 사용하지 않기 때문에 STATELESS로 설정하는 로직이다.</p><p><code class="language-plaintext highlighter-rouge">authorizeRequests()</code>: 애플리케이션에 들어오는 요청에 대한 사용 권한을 체크한다. ansMatchers()로 URI별 설정을 하고, 나머지에 대해선 anyRequest()로 설정한다. permitAll()은 해당 요청을 모두 허용한다는 것,hasRole(“[권한]”)은 특정 권한에 대해서만 허용한다는 것, 그리고 authenticated()는 인증된 권한을 가진 사용자에게만 허용한다는 것이다.</p><p><code class="language-plaintext highlighter-rouge">exceptionHandling().authenticationEntryPoint(jwtAuthenticationEntryPoint)</code>: 인증 과정에서 예외가 발생한 경우 예외를 전달한다.</p><p><code class="language-plaintext highlighter-rouge">exceptionHandling().accessDeniedHandler(jwtAccessDeniedHandler)</code>: 권한을 확인하는 과정에서 통과하지 못하는 예외가 발생할 경우 예외를 전달한다.</p><ul><li>커스텀 AccessDeniedHandler, AuthenticationEntryPoint</ul><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtAccessDeniedHandler</span> <span class="kd">implements</span> <span class="nc">AccessDeniedHandler</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
        <span class="nc">AccessDeniedException</span> <span class="n">exception</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
            <span class="n">response</span><span class="o">.</span><span class="na">sendRedirect</span><span class="o">(</span><span class="s">"/exception"</span><span class="o">);</span>
        <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>AccessDeniedException 은 액세스 권한이 없는 리소스에 접근할 경우 발생하는 예외이다. 이 예외를 처리하기 위해 AccessDeniedHandler 인터페이스가 사용되고, 앞의 SecurityConfiguration에서도 <code class="language-plaintext highlighter-rouge">exceptonHandling()</code> 메서드를 통해 추가했다. 위의 예제는 예외 발생시 “/exception”으로 리다이렉트 되도록 <code class="language-plaintext highlighter-rouge">sendRedirect()</code> 메서드를 활용하는 방식으로 구현되었다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtAuthenticationEntryPoint</span> <span class="kd">implements</span> <span class="nc">AuthenticationEntryPoint</span> <span class="o">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">commence</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
        <span class="nc">AuthenticationException</span> <span class="n">exception</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
        <span class="nc">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ObjectMapper</span><span class="o">();</span>

        <span class="nc">EntryPointErrorResponse</span> <span class="n">entryPointErrorResponse</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">EntryPointErrorResponse</span><span class="o">(</span><span class="s">"인증이 실패하였습니다."</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setStatus</span><span class="o">(</span><span class="mi">401</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">"application/json"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">setCharacterEncoding</span><span class="o">(</span><span class="s">"utf-8"</span><span class="o">);</span>
        <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">.</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">entryPointErrorResponse</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">///</span>
<span class="nd">@Getter</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@ToString</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EntryPointErrorResponse</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">message</span><span class="o">;</span>
<span class="o">}</span>
</pre></table></code></div></div><p>AuthenticationEntryPoint의 구조는 앞의 AccessDeniedHandler와 크게 다르지 않고, <code class="language-plaintext highlighter-rouge">commence()</code> 메서드를 오버라이딩 해 구현한다. 위의 예제는 예외 처리를 위해 직접 Response를 생성해 클라이언트에게 응답하는 방식으로 구현되었다. 만약 메시지를 설정할 필요가 없다면, 다음과 같이 <code class="language-plaintext highlighter-rouge">response.sendError()</code> 메서드로 인증 실패 코드만 전달할 수 있다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="복사되었습니다!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">//...</span>
    <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">commence</span><span class="o">(</span><span class="nc">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="nc">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span>
            <span class="nc">AuthenticationException</span> <span class="n">exception</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">IOException</span> <span class="o">{</span>
            <span class="n">response</span><span class="o">.</span><span class="na">sendError</span><span class="o">(</span><span class="nc">HttpServletResponse</span><span class="o">.</span><span class="na">SC_UNAUTHORIZED</span><span class="o">)</span>
        <span class="o">}</span>
<span class="c1">//...</span>
</pre></table></code></div></div><p>회원 가입과 로그인 기능의 컨트롤러와 서비스등 위의 구현 내용을 이어붙이는 것이기 때문에, 밑의 나머지 부분에 넣어 놓고 넘어가겠다.</p><details> <summary>나머지</summary> * SignService ```java @Service @AllArgsConstructor public class SignServiceImpl implements SignService { public UserRepository userRepository; public JwtTokenProvider jwtTokenProvider; // `@Configuration` 으로 BcryptEncoder를 등록시켜 주어야 한다. public PasswordEncoder passwordEncoder; @Override public SignUpResponseDto signUp(String username, String password, String email, String role) { SignUpResponseDto signUpResponseDto = new SignUpResponseDto(); User user = User.builder() .username(username) .password(passwordEncoder.encode(password)) .email(email) .role(role.equalsIgnoreCase("admin") ? UserRole.ADMIN : UserRole.USER) .build(); User savedUser = userRepository.save(user); if (savedUser.getUsername().isEmpty()) { setFailResult(signUpResponseDto); return signUpResponseDto; } setSuccessResult(signUpResponseDto); return signUpResponseDto; } @Override public SignInResponseDto signIn(String username, String password) throws RuntimeException { User user = userRepository.findByUsername(username); if(!passwordEncoder.matches(password, user.getPassword())) { throw new RuntimeException(); } SignInResponseDto signInResponseDto = SignInResponseDto.builder() .token(jwtTokenProvider.createToken(String.valueOf(user.getUsername()), Set.of(user.getRole().getName()))) .build(); setSuccessResult(signInResponseDto); return signInResponseDto; } private void setSuccessResult(SignUpResponseDto responseDto) { responseDto.setSuccess(true); responseDto.setCode(0); responseDto.setMessage("Success"); } private void setFailResult(SignUpResponseDto responseDto) { responseDto.setSuccess(false); responseDto.setCode(-1); responseDto.setMessage("Fail"); } } ``` * SignController ```java @RestController @RequestMapping("/sign-api") @AllArgsConstructor public class SignController { private final SignService signService; private final Logger LOGGER = LoggerFactory.getLogger(SignController.class); @PostMapping("/sign-in") public ResponseEntity<SignInResponseDto> signIn(@RequestBody SignInRequestDto requestDto) throws RuntimeException { SignInResponseDto responseDto = signService.signIn(requestDto.getUsername(), requestDto.getPassword()); return ResponseEntity.status(HttpStatus.OK).body(responseDto); } @PostMapping("sign-up") public ResponseEntity<SignUpResponseDto> createProduct(@RequestBody SignUpRequestDto requestDto) { SignUpResponseDto responseDto = signService.signUp(requestDto.getUsername(), requestDto.getPassword(), requestDto.getEmail(), requestDto.getRole()); return ResponseEntity.status(HttpStatus.OK).body(responseDto); } @GetMapping("/exception") public void exceptionTest() throws RuntimeException { throw new RuntimeException("접근이 금지되었습니다."); } @ExceptionHandler(value = RuntimeException.class) public ResponseEntity&lt;Map&lt;String, String&gt;&gt; ExceptionHandler(RuntimeException e) { // HttpHeaders responseHeaders = new HttpHeaders(); // responseHeaders.add(HttpHeaders.CONTENT_TYPE, "application/json"); HttpStatus httpStatus = HttpStatus.BAD_REQUEST; Map&lt;String, String&gt; map = new HashMap&lt;&gt;(); map.put("error type", httpStatus.getReasonPhrase()); map.put("code", "400"); map.put("message", "에러 발생"); return ResponseEntity.status(httpStatus).body(map); } } ``` * PasswordEncoderConfiguration ```java @Configuration public class PasswordEncoderConfiguration { // DB에 비밀번호 암호화해 저장 @Bean public PasswordEncoder passwordEncoder() { return new BCryptPasswordEncoder(); } } ``` * User 엔티티 ```java @Entity @Getter @NoArgsConstructor @AllArgsConstructor @Builder @Table public class User { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; @Column(nullable = false, unique = true) private String username; @JsonProperty(access = Access.WRITE_ONLY) @Column(nullable = false) private String password; @Column(nullable = false) private String email; @Column(name = "role") @Enumerated(EnumType.STRING) private UserRole role; } ``` * 그 외에 사용한 DTO들 ```java @Getter @AllArgsConstructor public class UserDto { private Long id; private String username; private String password; private String email; private UserRole role; public static UserDto from(User entity) { return new UserDto( entity.getId(), entity.getUsername(), entity.getPassword(), entity.getEmail(), entity.getRole() ); } } //----- @AllArgsConstructor @Getter public class SignInRequestDto{ private String username; private String password; } //----- @AllArgsConstructor @NoArgsConstructor @Builder @Getter public class SignInResponseDto extends SignUpResponseDto{ private String token; } //----- @AllArgsConstructor @NoArgsConstructor @Getter public class SignUpRequestDto { private String username; private String password; private String email; private String role; } //----- @AllArgsConstructor @NoArgsConstructor @Data public class SignUpResponseDto { private boolean success; private int code; private String message; } ``` &lt;/details&gt; ## 마치며 이 모든 과정에도 불구하고, JWT를 사용해 인증을 구현할 때에는 [주의를 요한다](https://velog.io/@thelm3716/JWTvul). 하지만 이 모든 주의사항을 숙지하고 방비한다면, JWT는 마이크로 서비스 아키텍처 기반 환경의 서비스에서 사용 가능한 안전하고 효율적인 인증 방식이 될 것이다. ## 참고 자료 *** * [스프링 시큐리티 공식 레퍼런스 번역 문서](https://godekdls.github.io/Spring%20Security/contents/) * [[Spring] Security WebSecurityConfigurerAdapter Deprecated 해결하기](https://devlog-wjdrbs96.tistory.com/434) * [스프링 시큐리티 비밀번호 암호화 설정](https://franklee0180.tistory.com/42) * [SpringBoot + JWT + Security + JPA 인증 구현, JWT란?](https://aljjabaegi.tistory.com/659) </SignUpResponseDto></SignInResponseDto></details></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/backend/'>Backend</a>, <a href='/categories/springboot/'>SpringBoot</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/tutorial/" class="post-tag no-text-decoration" >Tutorial</a> <a href="/tags/backend/" class="post-tag no-text-decoration" >Backend</a> <a href="/tags/spring/" class="post-tag no-text-decoration" >Spring</a> <a href="/tags/springboot/" class="post-tag no-text-decoration" >SpringBoot</a> <a href="/tags/java/" class="post-tag no-text-decoration" >Java</a> <a href="/tags/springsecurity/" class="post-tag no-text-decoration" >SpringSecurity</a> <a href="/tags/jwt/" class="post-tag no-text-decoration" >JWT</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=%5B%EB%B0%B1%EC%97%94%EB%93%9C%7C%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8%5D+%EC%84%9C%EB%B2%84%EA%B0%80+%EC%82%AC%EC%9A%A9%EC%9E%90%EB%A5%BC+%EC%9D%B8%EC%A6%9D%ED%95%98%EB%8A%94+%EB%B2%95+%28JWT%EB%A5%BC+%EC%9D%B4%EC%9A%A9%ED%95%9C+%EB%B0%A9%EB%B2%95%29+-+TaemHam&url=https%3A%2F%2Ftaemham.github.io%2Fposts%2FSpringBoot_AboutSpringSecurity%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=%5B%EB%B0%B1%EC%97%94%EB%93%9C%7C%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8%5D+%EC%84%9C%EB%B2%84%EA%B0%80+%EC%82%AC%EC%9A%A9%EC%9E%90%EB%A5%BC+%EC%9D%B8%EC%A6%9D%ED%95%98%EB%8A%94+%EB%B2%95+%28JWT%EB%A5%BC+%EC%9D%B4%EC%9A%A9%ED%95%9C+%EB%B0%A9%EB%B2%95%29+-+TaemHam&u=https%3A%2F%2Ftaemham.github.io%2Fposts%2FSpringBoot_AboutSpringSecurity%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Ftaemham.github.io%2Fposts%2FSpringBoot_AboutSpringSecurity%2F&text=%5B%EB%B0%B1%EC%97%94%EB%93%9C%7C%EC%8A%A4%ED%94%84%EB%A7%81%EB%B6%80%ED%8A%B8%5D+%EC%84%9C%EB%B2%84%EA%B0%80+%EC%82%AC%EC%9A%A9%EC%9E%90%EB%A5%BC+%EC%9D%B8%EC%A6%9D%ED%95%98%EB%8A%94+%EB%B2%95+%28JWT%EB%A5%BC+%EC%9D%B4%EC%9A%A9%ED%95%9C+%EB%B0%A9%EB%B2%95%29+-+TaemHam" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Springboot_FetchJoin+Paging_Problem/">[Springboot] 페이징 + Fetch Join 쿼리로 OneToMany 할 때, 모든 엔티티를 불러오는 문제를 해결해보자</a><li><a href="/posts/CS_DatabaseBasic/">[CS] DB: DB란 무엇인가?</a><li><a href="/posts/CS_About_Process/">[CS] OS: 프로세스란?</a><li><a href="/posts/CS_MultiProcess/">[CS] OS: 멀티 프로세싱과 멀티 스레딩</a><li><a href="/posts/SpringBoot_AboutSpringSecurity/">[백엔드|스프링부트] 서버가 사용자를 인증하는 법 (JWT를 이용한 방법)</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/backend/">Backend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/cs/">CS</a> <a class="post-tag" href="/tags/tutorial/">Tutorial</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/db/">DB</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/os/">OS</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/SpringBoot_AboutSB/"><div class="card-body"> <em class="small" data-ts="1663593600" data-df="YYYY-MM-DD" > 2022-09-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[백엔드|스프링부트] 스프링부트란?</h3><div class="text-muted small"><p> 백엔드 개발자로 웹 개발을 할 때 알야야 할, 특히 한국에서라면 거의 필수가 되는 기술 스택인 SpringBoot. 앞으로 몇 주간은 이에 대해 배우며, 공부한 내용을 포스팅 할 계획이다. 첫 포스트인만큼, 먼저 SpringBoot가 무엇인지 알아보자. 스프링 프레임워크 스프링 로고1 스프링부트는 스프링을 더욱 쉽게 사용할 수 있도록 하기 위해...</p></div></div></a></div><div class="card"> <a href="/posts/SpringBoot_WebModules/"><div class="card-body"> <em class="small" data-ts="1664107800" data-df="YYYY-MM-DD" > 2022-09-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[백엔드|스프링부트] 스프링 WEB 관련 모듈</h3><div class="text-muted small"><p> 스프링 프레임워크의 모듈1 이전 포스트에서도 언급했듯이, 스프링 프레임워크는 기능별로 구분된 약 20여 개의 모듈을 제공한다. 이 중에서 웹과 관련된 모듈들은 다음과 같다: spring-web spring-webmvc spring-websocket spring-webmvc-portlet 오늘은 이 네가지 모듈들이 각각 무엇인지,...</p></div></div></a></div><div class="card"> <a href="/posts/SpringBoot_Fundamentals/"><div class="card-body"> <em class="small" data-ts="1664182200" data-df="YYYY-MM-DD" > 2022-09-26 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[백엔드|스프링부트] 스프링 기본 개념</h3><div class="text-muted small"><p> 스프링 부트 웹 어플리케이션 개발에 앞서 알고 있어야 할 기초 지식에 대해 다루어보자. 마이크로서비스 아키텍처 어떤 포털 사이트에서 블로그, 카페, 메일 등 지원하는 서비스들을 하나의 어플리케이션에 통합해 개발한다고 가정하자. 만약 이렇게 구성한다면, 서버를 업데이트 하거나 어플리케이션 유지보수를 할 때마다 모든 서비스를 중단하고 작업을 진행할 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CS_IpAndMac/" class="btn btn-outline-primary" prompt="이전 글"><p>[CS] IP & MAC: 컴퓨터에서 보낸 메시지는 길을 어떻게 찾아가지?</p></a> <a href="/posts/CS_HTTP_history/" class="btn btn-outline-primary" prompt="다음 글"><p>[CS] HTTP 1.0 부터 3.0까지: HTTP 규약은 어떻게 변화해 왔나</p></a></div><script src="https://utteranc.es/client.js" repo="TaemHam/Taemham.github.io" issue-term="pathname" crossorigin="anonymous" async> </script> <script type="text/javascript"> $(function() { const origin = "https://utteranc.es"; const iframe = "iframe.utterances-frame"; const lightTheme = "github-light"; const darkTheme = "github-dark"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } addEventListener("message", (event) => { let theme; /* credit to <https://github.com/utterance/utterances/issues/170#issuecomment-594036347> */ if (event.origin === origin) { /* page initial */ theme = initTheme; } else if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); } else { return; } const message = { type: "set-theme", theme: theme }; const utterances = document.querySelector(iframe).contentWindow; utterances.postMessage(message, origin); }); }); </script></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/TaemHam">TaemHam</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/backend/">Backend</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/cs/">CS</a> <a class="post-tag" href="/tags/tutorial/">Tutorial</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/db/">DB</a> <a class="post-tag" href="/tags/network/">Network</a> <a class="post-tag" href="/tags/os/">OS</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
